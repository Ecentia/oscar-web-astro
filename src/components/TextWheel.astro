---
// src/components/TextWheel.astro
const phrases = [
  "OSCAR HERRERA - LIVE PERFORMANCE",
  "GLOBAL FREQUENCY - WORLD TOUR",
  "IBIZA RESIDENCY - ALL NIGHT LONG",
  "MADRID • BERLIN • TOKYO - 2025",
  "TECHNO CULTURE - UNDERGROUND",
  "MAIN STAGE - SOLD OUT SHOW",
  "SOUND SYSTEM - FULL VOLUME",
  "ELECTRONIC MUSIC - VIBES"
];

// Mantenemos la duplicación para que se vea el círculo perfecto
const items = [...phrases, ...phrases];
---

<div class="wheel-container">
  <div class="wheel-viewport">
    <div class="wheel" id="wheel">
      {items.map((phrase) => (
        <div class="wheel-card">
          <h2>{phrase}</h2>
        </div>
      ))}
    </div>
  </div>
</div>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const wheel = document.getElementById("wheel");
  const cards = gsap.utils.toArray(".wheel-card");
  const numCards = cards.length;
  
  // Configuración visual
  const radius = 350; 
  const angleStep = 360 / numCards;

  // 1. Posicionamiento inicial
  cards.forEach((card: any, index) => {
    gsap.set(card, {
      rotationX: -index * angleStep, 
      z: radius, 
      transformOrigin: "50% 50% " + -radius + "px"
    });
  });

  // 2. Animación con Scroll (DIRECCIÓN INVERTIDA)
  gsap.to(wheel, {
    rotationX: 360, // CAMBIO AQUÍ: Positivo para que baje al hacer scroll down
    ease: "none",
    scrollTrigger: {
      trigger: ".wheel-container",
      start: "top top",
      end: "+=2000", 
      pin: true, 
      scrub: 1, 
    }
  });
</script>

<style>
  .wheel-container {
    height: 100vh;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #000;
    overflow: hidden;
  }

  .wheel-viewport {
    perspective: 1200px;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 85%, transparent 100%);
    -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 15%, black 85%, transparent 100%);
  }

  .wheel {
    position: relative;
    width: 100%;
    height: 100px;
    transform-style: preserve-3d;
  }

  .wheel-card {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    backface-visibility: hidden;
  }

  h2 {
    font-family: 'Impact', sans-serif;
    font-size: 4rem; 
    color: transparent;
    -webkit-text-stroke: 1.5px rgba(255, 255, 255, 0.9);
    text-transform: uppercase;
    white-space: nowrap;
    margin: 0;
    letter-spacing: 2px;
  }
  
  @media (max-width: 768px) {
    h2 { font-size: 2.5rem; }
  }
</style>