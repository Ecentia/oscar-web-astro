---
const tourDates = [
    { date: "24 OCT", city: "MADRID", venue: "FABRIK", status: "SOLD OUT" },
    { date: "31 OCT", city: "IBIZA", venue: "DC-10", status: "TICKETS" },
    { date: "12 NOV", city: "LONDON", venue: "PRINTWORKS", status: "TICKETS" },
    { date: "05 DEC", city: "BERLIN", venue: "BERGHAIN", status: "TICKETS" },
    { date: "18 DEC", city: "TOKYO", venue: "WOMB", status: "WAITLIST" },
    { date: "31 DEC", city: "NEW YORK", venue: "BASEMENT", status: "TICKETS" },
];
---

<section class="tour-section" id="tour">
    
    <div class="tour-header">
        <h2 class="section-title">PRÓXIMAS<br>FECHAS</h2>
        <div class="header-meta">
            <span>2025 / 2026 SEASON</span>
            <span>WORLDWIDE</span>
        </div>
    </div>

    <div class="tour-list">
        <!-- Header de la tabla (oculto en móvil) -->
        <div class="tour-row header-row">
            <span class="col date">DATE</span>
            <span class="col city">CITY</span>
            <span class="col venue">VENUE</span>
            <span class="col action">STATUS</span>
        </div>

        {tourDates.map((gig) => (
            <div class="tour-row item-row">
                <div class="col date">{gig.date}</div>
                <div class="col city">{gig.city}</div>
                <div class="col venue">{gig.venue}</div>
                <div class="col action">
                    <a href="#" class={`ticket-btn ${gig.status === 'SOLD OUT' ? 'sold-out' : ''}`}>
                        {gig.status}
                    </a>
                </div>
                <div class="row-bg"></div>
            </div>
        ))}
    </div>

</section>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    const rows = document.querySelectorAll('.item-row');

    // 1. Animación de entrada (Reveal)
    gsap.from(rows, {
        scrollTrigger: {
            trigger: ".tour-list",
            start: "top 80%",
        },
        y: 50,
        opacity: 0,
        duration: 0.8,
        stagger: 0.1,
        ease: "power3.out"
    });

    // 2. Hover Effect (Inversión de color limpia)
    rows.forEach(row => {
        const btn = row.querySelector('.ticket-btn');
        
        row.addEventListener('mouseenter', () => {
            gsap.to(row, { color: "#000", backgroundColor: "#fff", duration: 0.3 });
            if(btn) gsap.to(btn, { borderColor: "#000", color: "#000", duration: 0.3 });
        });
        
        row.addEventListener('mouseleave', () => {
            gsap.to(row, { color: "#fff", backgroundColor: "transparent", duration: 0.3 });
            if(btn) gsap.to(btn, { borderColor: "#fff", color: "#fff", duration: 0.3 });
        });
    });
</script>

<style>
    .tour-section {
        background-color: #050505;
        color: #fff;
        padding: 100px 4vw;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    /* --- HEADER --- */
    .tour-header {
        margin-bottom: 80px;
        border-bottom: 1px solid rgba(255,255,255,0.2);
        padding-bottom: 40px;
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        flex-wrap: wrap;
        gap: 20px;
    }

    .section-title {
        font-family: var(--font-display, sans-serif);
        font-size: 8vw;
        line-height: 0.85;
        margin: 0;
        text-transform: uppercase;
        letter-spacing: -0.02em;
    }

    .header-meta {
        font-family: var(--font-mono, monospace);
        font-size: 0.9rem;
        text-align: right;
        display: flex;
        flex-direction: column;
        gap: 5px;
        opacity: 0.7;
    }

    /* --- LIST --- */
    .tour-list {
        display: flex;
        flex-direction: column;
    }

    .tour-row {
        display: grid;
        grid-template-columns: 1fr 2fr 2fr 1fr; /* Grid layout */
        align-items: center;
        padding: 30px 0;
        border-bottom: 1px solid rgba(255,255,255,0.15);
        position: relative;
        transition: padding 0.3s ease; /* Smooth hover padding */
    }

    .header-row {
        font-family: var(--font-mono, monospace);
        font-size: 0.8rem;
        opacity: 0.5;
        letter-spacing: 0.1em;
        padding-bottom: 15px;
        border-bottom: 2px solid #fff; /* Línea más gruesa para el header */
    }

    .item-row {
        font-family: var(--font-display, sans-serif);
        font-size: 2.5rem; /* Texto grande */
        text-transform: uppercase;
        cursor: pointer;
        padding-left: 10px; /* Espacio para hover */
        padding-right: 10px;
    }
    
    .item-row:last-child {
        border-bottom: none;
    }

    /* --- COLUMNS --- */
    .col.date { font-family: var(--font-mono, monospace); font-size: 1rem; letter-spacing: 0.1em; }
    .col.action { display: flex; justify-content: flex-end; }

    /* --- BUTTON --- */
    .ticket-btn {
        font-family: var(--font-mono, monospace);
        font-size: 0.8rem;
        padding: 10px 25px;
        border: 1px solid #fff;
        border-radius: 50px;
        text-decoration: none;
        color: #fff;
        transition: all 0.3s;
        white-space: nowrap;
    }

    .ticket-btn.sold-out {
        opacity: 0.5;
        text-decoration: line-through;
        pointer-events: none;
        border-color: #555;
        color: #555;
    }

    /* --- RESPONSIVE --- */
    @media (max-width: 900px) {
        .tour-row {
            grid-template-columns: 1fr auto;
            grid-template-areas: 
                "city action"
                "venue venue"
                "date date";
            gap: 5px;
            padding: 25px 0;
        }

        .header-row { display: none; } /* Ocultamos header en móvil */

        .col.city { grid-area: city; font-size: 2rem; }
        .col.venue { grid-area: venue; font-size: 1.2rem; opacity: 0.7; font-family: var(--font-mono); }
        .col.date { grid-area: date; font-size: 0.9rem; opacity: 0.5; margin-top: 10px; }
        .col.action { grid-area: action; }
        
        .section-title { font-size: 14vw; }
    }
</style>